<?php

    /**
     * Short - 
     * 
     * Detailed - 
     * 
     * @param string $status
     * 
     * @return bool
     */
    function isPaid($status) {
        logEvent('isPaid()');
        switch($status) {
            case 'ACCEPTED':
            case 'AUTHORISED':
            case 'CAPTURED':
                return true;
            case 'ABANDONED':
            case 'AUTHORISED_TO_VALIDATE':
            case 'CANCELLED':
            case 'CAPTURE_FAILED':
            case 'EXPIRED':
            case 'REFUSED':
            case 'SUSPENDED':
            case 'UNDER_VERIFICATION':
            case 'WAITING_AUTHORISATION':
            case 'WAITING_AUTHORISATION_TO_VALIDAT':
            default:
                return false;
        }
    }

    /**
     * Short - 
     * 
     * Detailed - 
     * 
     * @param string|null $pays
     * 
     * @return bool
     */
    function tva_intra($pays = null) {
        logEvent('tva_intra()');
        switch($pays)
        {
            case 'Belgique':
            case 'Luxembourg':
                return true;
            case 'France':
            default:
                return false;
        }
    }

    function orderDivider() {
        $retour = '';
        // $retour .= '<!-- DIVIDER -->';
        $retour .= '<table class="module" role="module" data-type="divider" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '    <tbody>';
        $retour .= '        <tr>';
        $retour .= '            <td style="padding:0px 0px 0px 0px;" role="module-content" height="100%" valign="top" bgcolor="">';
        $retour .= '                <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" height="2px" style="line-height:2px; font-size:2px;">';
        $retour .= '                    <tbody>';
        $retour .= '                        <tr>';
        $retour .= '                            <td style="padding:0px 0px 2px 0px;" bgcolor="#f2f2f2"></td>';
        $retour .= '                        </tr>';
        $retour .= '                    </tbody>';
        $retour .= '                </table>';
        $retour .= '            </td>';
        $retour .= '        </tr>';
        $retour .= '    </tbody>';
        $retour .= '</table>';
        // $retour .= '<!-- END DIVIDER -->';
        return $retour;
    }

    function orderBillingShippingLine($title, $value) {
        $retour = '';
        $retour .= '<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" role="module" data-type="columns" style="padding:0px 0px 0px 0px;" bgcolor="#0b1a25" data-distribution="1,2">';
        $retour .= '    <tbody>';
        $retour .= '        <tr role="module-content">';
        $retour .= '            <td height="100%" valign="top">';
        $retour .= '                <table width="200" style="width:200px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-0">';
        $retour .= '                    <tbody>';
        $retour .= '                        <tr>';
        $retour .= '                            <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                    <tbody>';
        $retour .= '                                        <tr>';
        $retour .= '                                            <td style="padding:0px 0px 2px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                <div>';
        $retour .= '                                                    <div style="font-family: inherit; text-align: inherit">'.$title.'</div>';
        $retour .= '                                                    <div></div>';
        $retour .= '                                                </div>';
        $retour .= '                                            </td>';
        $retour .= '                                        </tr>';
        $retour .= '                                    </tbody>';
        $retour .= '                                </table>';
        $retour .= '                            </td>';
        $retour .= '                        </tr>';
        $retour .= '                    </tbody>';
        $retour .= '                </table>';
        $retour .= '                <table width="400" style="width:400px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-1">';
        $retour .= '                    <tbody>';
        $retour .= '                        <tr>';
        $retour .= '                            <td';
        $retour .= '                                style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                    <tbody>';
        $retour .= '                                        <tr>';
        $retour .= '                                            <td style="padding:0px 0px 2px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                <div>';
        $retour .= '                                                    <div';
        $retour .= '                                                        style="font-family: inherit; text-align: inherit">'.$value.'</div>';
        $retour .= '                                                    <div></div>';
        $retour .= '                                                </div>';
        $retour .= '                                            </td>';
        $retour .= '                                        </tr>';
        $retour .= '                                    </tbody>';
        $retour .= '                                </table>';
        $retour .= '                            </td>';
        $retour .= '                        </tr>';
        $retour .= '                    </tbody>';
        $retour .= '                </table>';
        $retour .= '            </td>';
        $retour .= '        </tr>';
        $retour .= '    </tbody>';
        $retour .= '</table>';
        return $retour;
    }

    function orderZoneTitle($title) {
        $retour = '';
        $retour .= '<table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '    <tbody>';
        $retour .= '        <tr>';
        $retour .= '            <td style="padding:18px 0px 0px 0px; line-height:22px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                <div>';
        $retour .= '                    <div style="font-family: inherit; text-align: inherit">';
        $retour .= '                        <span style="font-size: 18px"><strong>'.$title.'</strong></span>';
        $retour .= '                    </div>';
        $retour .= '                    <div></div>';
        $retour .= '                </div>';
        $retour .= '            </td>';
        $retour .= '        </tr>';
        $retour .= '    </tbody>';
        $retour .= '</table>';
        return $retour;
    }

function orderMailHTML() {
    $retour = '';
    $retour .= '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">';
    $retour .= '<html data-editor-version="2" class="sg-campaigns" xmlns="http://www.w3.org/1999/xhtml">';
    $retour .= '';
    $retour .= '<head>';
    $retour .= '    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">';
    $retour .= '    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">';
    $retour .= '    <!--[if !mso]><!-->';
    $retour .= '        <meta http-equiv="X-UA-Compatible" content="IE=Edge">';
    $retour .= '    <!--<![endif]-->';
    $retour .= '    <!--[if (gte mso 9)|(IE)]>';
    $retour .= '        <xml>';
    $retour .= '            <o:OfficeDocumentSettings>';
    $retour .= '            <o:AllowPNG/>';
    $retour .= '            <o:PixelsPerInch>96</o:PixelsPerInch>';
    $retour .= '            </o:OfficeDocumentSettings>';
    $retour .= '        </xml>';
    $retour .= '    <![endif]-->';
    $retour .= '    <!--[if (gte mso 9)|(IE)]>';
    $retour .= '        <style type="text/css">';
    $retour .= '            body {width: 600px;margin: 0 auto;}';
    $retour .= '            table {border-collapse: collapse;}';
    $retour .= '            table, td {mso-table-lspace: 0pt;mso-table-rspace: 0pt;}';
    $retour .= '            img {-ms-interpolation-mode: bicubic;}';
    $retour .= '        </style>';
    $retour .= '    <![endif]-->';
    $retour .= '    <style type="text/css">';
    $retour .= '        body,';
    $retour .= '        p,';
    $retour .= '        div {';
    $retour .= '            font-family: verdana, geneva, sans-serif;';
    $retour .= '            font-size: 14px;';
    $retour .= '        }';
    $retour .= '        body {';
    $retour .= '            color: #f2f2f2;';
    $retour .= '            margin: 0;';
    $retour .= '        }';
    $retour .= '        body a {';
    $retour .= '            color: #f2f2f2;';
    $retour .= '            text-decoration: none;';
    $retour .= '        }';
    $retour .= '        p {';
    $retour .= '            margin: 0;';
    $retour .= '            padding: 0;';
    $retour .= '        }';
    $retour .= '        table.wrapper {';
    $retour .= '            width: 100% !important;';
    $retour .= '            table-layout: fixed;';
    $retour .= '            -webkit-font-smoothing: antialiased;';
    $retour .= '            -webkit-text-size-adjust: 100%;';
    $retour .= '            -moz-text-size-adjust: 100%;';
    $retour .= '            -ms-text-size-adjust: 100%;';
    $retour .= '        }';
    $retour .= '        img.max-width {';
    $retour .= '            max-width: 100% !important;';
    $retour .= '        }';
    $retour .= '        .column.of-2 {';
    $retour .= '            width: 50%;';
    $retour .= '        }';
    $retour .= '        .column.of-3 {';
    $retour .= '            width: 33.333%;';
    $retour .= '        }';
    $retour .= '        .column.of-4 {';
    $retour .= '            width: 25%;';
    $retour .= '        }';
    $retour .= '        ul ul ul ul {';
    $retour .= '            list-style-type: disc !important;';
    $retour .= '        }';
    $retour .= '        ol ol {';
    $retour .= '            list-style-type: lower-roman !important;';
    $retour .= '        }';
    $retour .= '        ol ol ol {';
    $retour .= '            list-style-type: lower-latin !important;';
    $retour .= '        }';
    $retour .= '        ol ol ol ol {';
    $retour .= '            list-style-type: decimal !important;';
    $retour .= '        }';
    $retour .= '        @media screen and (max-width:480px) {';
    $retour .= '            .preheader .rightColumnContent,';
    $retour .= '            .footer .rightColumnContent {';
    $retour .= '                text-align: left !important;';
    $retour .= '            }';
    $retour .= '            .preheader .rightColumnContent div,';
    $retour .= '            .preheader .rightColumnContent span,';
    $retour .= '            .footer .rightColumnContent div,';
    $retour .= '            .footer .rightColumnContent span {';
    $retour .= '                text-align: left !important;';
    $retour .= '            }';
    $retour .= '            .preheader .rightColumnContent,';
    $retour .= '            .preheader .leftColumnContent {';
    $retour .= '                font-size: 80% !important;';
    $retour .= '                padding: 5px 0;';
    $retour .= '            }';
    $retour .= '            table.wrapper-mobile {';
    $retour .= '                width: 100% !important;';
    $retour .= '                table-layout: fixed;';
    $retour .= '            }';
    $retour .= '            img.max-width {';
    $retour .= '                height: auto !important;';
    $retour .= '                max-width: 100% !important;';
    $retour .= '            }';
    $retour .= '            a.bulletproof-button {';
    $retour .= '                display: block !important;';
    $retour .= '                width: auto !important;';
    $retour .= '                font-size: 80%;';
    $retour .= '                padding-left: 0 !important;';
    $retour .= '                padding-right: 0 !important;';
    $retour .= '            }';
    $retour .= '            .columns {';
    $retour .= '                width: 100% !important;';
    $retour .= '            }';
    $retour .= '            .column {';
    $retour .= '                display: block !important;';
    $retour .= '                width: 100% !important;';
    $retour .= '                padding-left: 0 !important;';
    $retour .= '                padding-right: 0 !important;';
    $retour .= '                margin-left: 0 !important;';
    $retour .= '                margin-right: 0 !important;';
    $retour .= '            }';
    $retour .= '            .social-icon-column {';
    $retour .= '                display: inline-block !important;';
    $retour .= '            }';
    $retour .= '        }';
    $retour .= '    </style>';
    $retour .= '    <!--user entered Head Start-->';
    $retour .= '    <!--End Head user entered-->';
    $retour .= '</head>';
    $retour .= '';
    // $retour .= '<!-- BODY -->';
    $retour .= '<body>';
    $retour .= '    <center class="wrapper" data-link-color="#f2f2f2" data-body-style="font-size:14px; font-family:verdana,geneva,sans-serif; color:#f2f2f2; background-color:#0b1a25;">';
    $retour .= '        <div class="webkit">';
    $retour .= '            <table cellpadding="0" cellspacing="0" border="0" width="100%" class="wrapper" bgcolor="#0b1a25">';
    $retour .= '                <tr>';
    $retour .= '                    <td valign="top" bgcolor="#0b1a25" width="100%">';
    $retour .= '                        <table width="100%" role="content-container" class="outer" align="center" cellpadding="0" cellspacing="0" border="0">';
    $retour .= '                            <tr>';
    $retour .= '                                <td width="100%">';
    $retour .= '                                    <table width="100%" cellpadding="0" cellspacing="0" border="0">';
    $retour .= '                                        <tr>';
    $retour .= '                                            <td>';
    $retour .= '                                                <!--[if mso]>';
    $retour .= '                                                        <center>';
    $retour .= '                                                            <table>';
    $retour .= '                                                                <tr>';
    $retour .= '                                                                    <td width="600">';
    $retour .= '                                                <![endif]-->';
    $retour .= '                                                <table width="100%" cellpadding="0" cellspacing="0" border="0" style="width:100%; max-width:600px;" align="center">';
    $retour .= '                                                    <tr>';
    $retour .= '                                                        <td role="modules-container" style="padding:0px 0px 0px 0px; color:#f2f2f2; text-align:left;" bgcolor="#0b1a25" width="100%" align="left">';
    $retour .= '                                                            <table class="module preheader preheader-hide" role="module" data-type="preheader" border="0" cellpadding="0" cellspacing="0" width="100%" style="display: none !important; mso-hide: all; visibility: hidden; opacity: 0; color: transparent; height: 0; width: 0;">';
    $retour .= '                                                                <tr>';
    $retour .= '                                                                    <td role="module-content">';
    $retour .= '                                                                        <p></p>';
    $retour .= '                                                                    </td>';
    $retour .= '                                                                </tr>';
    $retour .= '                                                            </table>';
    // $retour .= '                                                            <!-- HEADER -->';
    $retour .= '                                                            <table class="wrapper" role="module" data-type="image" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                <tbody>';
    $retour .= '                                                                    <tr>';
    $retour .= '                                                                        <td style="font-size:6px; line-height:10px; padding:0px 0px 0px 0px;" valign="top" align="center">';
    $retour .= '                                                                            <img class="max-width" border="0" style="display:block; color:#000000; text-decoration:none; font-family:Helvetica, arial, sans-serif; font-size:16px; max-width:100% !important; width:100%; height:auto !important;" width="600" alt="" data-proportionally-constrained="true" data-responsive="true" src="https://inmode.emeka.fr/back/assets/images/header-logo.png">';
    $retour .= '                                                                        </td>';
    $retour .= '                                                                    </tr>';
    $retour .= '                                                                </tbody>';
    $retour .= '                                                            </table>';
    // $retour .= '                                                            <!-- END HEADER -->';
    // $retour .= '                                                            <!-- RECEIVED -->';
    $retour .= '                                                            <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                <tbody>';
    $retour .= '                                                                    <tr>';
    $retour .= '                                                                        <td style="padding:25px 0px 10px 0px; line-height:22px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
    $retour .= '                                                                            <div>';
    $retour .= '                                                                                <div style="font-family: inherit; text-align: inherit">';
    if($_POST['for'] == 'client')
    {
        $retour .= 'Nous avons bien reçu votre commande <span style="font-size:20px;font-weight:600;">'.$_POST['Reference'].'</span> effectuée le ';
        $retour .= '<span style="font-size:20px;font-weight:600;">'.buildDate($_POST['Date'], 'full').' UTC</span>. ';
    }
    if($_POST['for'] == 'pro')
    {
        $retour .= 'Une nouvelle commande <span style="font-size:20px;font-weight:600;">'.$_POST['Reference'].'</span> est arrivée.';
    }
    if($_POST['for'] == 'client' && $_POST['type'] == 'sepa')
    {
        $retour .= ' Votre commande vous sera expédiée une fois que vous aurez effectué un virement sur le RIB suivant:';
    }
    if($_POST['for'] == 'client' && $_POST['type'] == 'soge')
    {
        $retour .= ' Votre commande sera expédiée sous peu.';
    }
    if($_POST['for'] == 'pro' && $_POST['type'] == 'sepa')
    {
        $retour .= ' Paiement par virement en attente.';
    }
    if($_POST['for'] == 'pro' && $_POST['type'] == 'soge')
    {
        $retour .= ' Le paiement est '.(isPaid($_POST['Status']) == true ? 'validé' : 'en attente').'.';
    }
    $retour .= '                                                                                </div>';
    $retour .= '                                                                                <div></div>';
    $retour .= '                                                                            </div>';
    $retour .= '                                                                        </td>';
    $retour .= '                                                                    </tr>';
    $retour .= '                                                                </tbody>';
    $retour .= '                                                            </table>';
    $retour .= orderDivider();
    if($_POST['for'] == 'client' && $_POST['type'] == 'sepa') {
        // $retour .= '                                                           <!-- RIB -->';
        $retour .= '                                                           <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" role="module" data-type="columns" style="padding:0px 0px 0px 0px;" bgcolor="#0b1a25" data-distribution="1,3">';
        $retour .= '                                                               <tbody>';
        $retour .= '                                                                   <tr role="module-content">';
        $retour .= '                                                                       <td height="100%" valign="top">';
        $retour .= '                                                                           <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-0">';
        $retour .= '                                                                               <tbody>';
        $retour .= '                                                                                   <tr>';
        $retour .= '                                                                                       <td';
        $retour .= '                                                                                           style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                           <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                               <tbody>';
        $retour .= '                                                                                                   <tr>';
        $retour .= '                                                                                                       <td style="padding:0px 0px 0px 0px; line-height:22px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                           <div>';
        $retour .= '                                                                                                               <div style="font-family: inherit; text-align: inherit">';
        $retour .= '                                                                                                                   <strong>RIB</strong>';
        $retour .= '                                                                                                               </div>';
        $retour .= '                                                                                                               <div></div>';
        $retour .= '                                                                                                           </div>';
        $retour .= '                                                                                                       </td>';
        $retour .= '                                                                                                   </tr>';
        $retour .= '                                                                                               </tbody>';
        $retour .= '                                                                                           </table>';
        $retour .= '                                                                                       </td>';
        $retour .= '                                                                                   </tr>';
        $retour .= '                                                                               </tbody>';
        $retour .= '                                                                           </table>';
        $retour .= '                                                                           <table width="450" style="width:450px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-1">';
        $retour .= '                                                                               <tbody>';
        $retour .= '                                                                                   <tr>';
        $retour .= '                                                                                       <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                           <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                               <tbody>';
        $retour .= '                                                                                                   <tr>';
        $retour .= '                                                                                                       <td style="padding:0px 0px 0px 0px; line-height:22px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                           <div>';
        $retour .= '                                                                                                               <div style="font-family: inherit; text-align: inherit">';
        $retour .= '                                                                                                                   FR76 3000 3015 7800 0200 1741 805';
        $retour .= '                                                                                                               </div>';
        $retour .= '                                                                                                               <div></div>';
        $retour .= '                                                                                                           </div>';
        $retour .= '                                                                                                       </td>';
        $retour .= '                                                                                                   </tr>';
        $retour .= '                                                                                               </tbody>';
        $retour .= '                                                                                           </table>';
        $retour .= '                                                                                       </td>';
        $retour .= '                                                                                   </tr>';
        $retour .= '                                                                               </tbody>';
        $retour .= '                                                                           </table>';
        $retour .= '                                                                       </td>';
        $retour .= '                                                                   </tr>';
        $retour .= '                                                               </tbody>';
        $retour .= '                                                           </table>';
        // $retour .= '                                                           <!-- END RIB -->';
        // $retour .= '                                                           <!-- BIC -->';
        $retour .= '                                                           <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" role="module" data-type="columns" style="padding:0px 0px 0px 0px;" bgcolor="#0b1a25" data-distribution="1,3">';
        $retour .= '                                                               <tbody>';
        $retour .= '                                                                   <tr role="module-content">';
        $retour .= '                                                                       <td height="100%" valign="top">';
        $retour .= '                                                                           <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-0">';
        $retour .= '                                                                               <tbody>';
        $retour .= '                                                                                   <tr>';
        $retour .= '                                                                                       <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                           <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                               <tbody>';
        $retour .= '                                                                                                   <tr>';
        $retour .= '                                                                                                       <td style="padding:0px 0px 0px 0px; line-height:22px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                           <div>';
        $retour .= '                                                                                                               <div style="font-family: inherit; text-align: inherit">';
        $retour .= '                                                                                                                   <strong>BIC</strong>';
        $retour .= '                                                                                                               </div>';
        $retour .= '                                                                                                               <div></div>';
        $retour .= '                                                                                                           </div>';
        $retour .= '                                                                                                       </td>';
        $retour .= '                                                                                                   </tr>';
        $retour .= '                                                                                               </tbody>';
        $retour .= '                                                                                           </table>';
        $retour .= '                                                                                       </td>';
        $retour .= '                                                                                   </tr>';
        $retour .= '                                                                               </tbody>';
        $retour .= '                                                                           </table>';
        $retour .= '                                                                           <table width="450" style="width:450px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-1">';
        $retour .= '                                                                               <tbody>';
        $retour .= '                                                                                   <tr>';
        $retour .= '                                                                                       <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                           <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                               <tbody>';
        $retour .= '                                                                                                   <tr>';
        $retour .= '                                                                                                       <td style="padding:0px 0px 0px 0px; line-height:22px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                           <div>';
        $retour .= '                                                                                                               <div style="font-family: inherit; text-align: inherit">';
        $retour .= '                                                                                                                   SOGEFRPP';
        $retour .= '                                                                                                               </div>';
        $retour .= '                                                                                                               <div></div>';
        $retour .= '                                                                                                           </div>';
        $retour .= '                                                                                                       </td>';
        $retour .= '                                                                                                   </tr>';
        $retour .= '                                                                                               </tbody>';
        $retour .= '                                                                                           </table>';
        $retour .= '                                                                                       </td>';
        $retour .= '                                                                                   </tr>';
        $retour .= '                                                                               </tbody>';
        $retour .= '                                                                           </table>';
        $retour .= '                                                                       </td>';
        $retour .= '                                                                   </tr>';
        $retour .= '                                                               </tbody>';
        $retour .= '                                                           </table>';
        // $retour .= '                                                           <!-- END BIC -->';
    }
    $retour .= orderDivider();
    // $retour .= '                                                            <!-- FACTURATION -->';
    // $retour .= '                                                            <!-- FACTURATION TITLE -->';
    $retour .= orderZoneTitle('Détails de la commande');
    // $retour .= '                                                            <!-- END FACTURATION TITLE -->';
    $retour .= orderDivider();
    $tva = 0;
    foreach($_POST['Article'] as $article) {
        // $retour .= '                                                            <!-- ARTICLE -->';
        $retour .= '                                                            <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" role="module" data-type="columns" style="padding:0px 0px 0px 0px;" bgcolor="#0b1a25" data-distribution="1,1,1,1">';
        $retour .= '                                                                <tbody>';
        $retour .= '                                                                    <tr role="module-content">';
        $retour .= '                                                                        <td height="100%" valign="top">';
        $retour .= '                                                                            <table width="135" style="width:135px; border-spacing:0; border-collapse:collapse; margin:0px 10px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-0">';
        $retour .= '                                                                                <tbody>';
        $retour .= '                                                                                    <tr>';
        $retour .= '                                                                                        <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                            <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                                <tbody>';
        $retour .= '                                                                                                    <tr>';
        $retour .= '                                                                                                        <td style="padding:0px 0px 5px 0px; line-height:20px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                            <div>';
        $retour .= '                                                                                                                <div style="font-family: inherit; text-align: inherit">';
        $retour .= '                                                                                                                    <span style="color: #f2f2f2">'.$article['Name'].'</span>';
        $retour .= '                                                                                                                </div>';
        $retour .= '                                                                                                                <div></div>';
        $retour .= '                                                                                                            </div>';
        $retour .= '                                                                                                        </td>';
        $retour .= '                                                                                                    </tr>';
        $retour .= '                                                                                                </tbody>';
        $retour .= '                                                                                            </table>';
        $retour .= '                                                                                        </td>';
        $retour .= '                                                                                    </tr>';
        $retour .= '                                                                                </tbody>';
        $retour .= '                                                                            </table>';
        $retour .= '                                                                            <table width="135" style="width:135px; border-spacing:0; border-collapse:collapse; margin:0px 10px 0px 10px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-1">';
        $retour .= '                                                                                <tbody>';
        $retour .= '                                                                                    <tr>';
        $retour .= '                                                                                        <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                            <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                                <tbody>';
        $retour .= '                                                                                                    <tr>';
        $retour .= '                                                                                                        <td style="padding:0px 0px 5px 0px; line-height:20px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                            <div>';
        $retour .= '                                                                                                                <div style="font-family: inherit; text-align: inherit">'.$article['Pack'].'</div>';
        $retour .= '                                                                                                                <div></div>';
        $retour .= '                                                                                                            </div>';
        $retour .= '                                                                                                        </td>';
        $retour .= '                                                                                                    </tr>';
        $retour .= '                                                                                                </tbody>';
        $retour .= '                                                                                            </table>';
        $retour .= '                                                                                        </td>';
        $retour .= '                                                                                    </tr>';
        $retour .= '                                                                                </tbody>';
        $retour .= '                                                                            </table>';
        $retour .= '                                                                            <table width="135" style="width:135px; border-spacing:0; border-collapse:collapse; margin:0px 10px 0px 10px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-2">';
        $retour .= '                                                                                <tbody>';
        $retour .= '                                                                                    <tr>';
        $retour .= '                                                                                        <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                            <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                                <tbody>';
        $retour .= '                                                                                                    <tr>';
        $retour .= '                                                                                                        <td style="padding:0px 0px 5px 0px; line-height:20px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                            <div>';
        $retour .= '                                                                                                                <div style="font-family: inherit; text-align: inherit">';
        $retour .= 'x '.$article['Quantity'];
        $retour .= '                                                                                                                </div>';
        $retour .= '                                                                                                                <div></div>';
        $retour .= '                                                                                                            </div>';
        $retour .= '                                                                                                        </td>';
        $retour .= '                                                                                                    </tr>';
        $retour .= '                                                                                                </tbody>';
        $retour .= '                                                                                            </table>';
        $retour .= '                                                                                        </td>';
        $retour .= '                                                                                    </tr>';
        $retour .= '                                                                                </tbody>';
        $retour .= '                                                                            </table>';
        $retour .= '                                                                            <table width="135" style="width:135px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 10px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-3">';
        $retour .= '                                                                                <tbody>';
        $retour .= '                                                                                    <tr>';
        $retour .= '                                                                                        <td';
        $retour .= '                                                                                            style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                            <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                                <tbody>';
        $retour .= '                                                                                                    <tr>';
        $retour .= '                                                                                                        <td style="padding:0px 0px 5px 0px; line-height:20px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                            <div>';
        $retour .= '                                                                                                                <div style="font-family: inherit; text-align: right">'.$article['Quantity'] * $article['Price'].' EUR</div>';
        $retour .= '                                                                                                                <div></div>';
        $retour .= '                                                                                                            </div>';
        $retour .= '                                                                                                        </td>';
        $retour .= '                                                                                                    </tr>';
        $retour .= '                                                                                                </tbody>';
        $retour .= '                                                                                            </table>';
        $retour .= '                                                                                        </td>';
        $retour .= '                                                                                    </tr>';
        $retour .= '                                                                                </tbody>';
        $retour .= '                                                                            </table>';
        $retour .= '                                                                        </td>';
        $retour .= '                                                                    </tr>';
        $retour .= '                                                                </tbody>';
        $retour .= '                                                            </table>';
        // $retour .= '                                                            <!-- END ARTICLE -->';
        $tva += $article['Quantity'] * $article['Price'];
    }
    $retour .= orderDivider();
    // $retour .= '                                                            <!-- FACTURATION CONCLUSION -->';
    if($_POST['DeliveryTax'] != null && is_numeric($$_POST['DeliveryTax']) && $$_POST['DeliveryTax'] > 0) {
        // $retour .= '                                                       <!-- LIVRAISON -->';
        $retour .= '                                                       <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" role="module" data-type="columns" style="padding:0px 0px 0px 0px;" bgcolor="#0b1a25" data-distribution="1,1,1,1">';
        $retour .= '                                                           <tbody>';
        $retour .= '                                                               <tr role="module-content">';
        $retour .= '                                                                   <td height="100%" valign="top">';
        $retour .= '                                                                       <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-0">';
        $retour .= '                                                                           <tbody>';
        $retour .= '                                                                               <tr>';
        $retour .= '                                                                                   <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                       <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                           <tbody>';
        $retour .= '                                                                                               <tr>';
        $retour .= '                                                                                                   <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                       <div>';
        $retour .= '                                                                                                           <div style="font-family: inherit; text-align: inherit"></div>';
        $retour .= '                                                                                                           <div></div>';
        $retour .= '                                                                                                       </div>';
        $retour .= '                                                                                                   </td>';
        $retour .= '                                                                                               </tr>';
        $retour .= '                                                                                           </tbody>';
        $retour .= '                                                                                       </table>';
        $retour .= '                                                                                   </td>';
        $retour .= '                                                                               </tr>';
        $retour .= '                                                                           </tbody>';
        $retour .= '                                                                       </table>';
        $retour .= '                                                                       <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-1">';
        $retour .= '                                                                           <tbody>';
        $retour .= '                                                                               <tr>';
        $retour .= '                                                                                   <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                       <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                           <tbody>';
        $retour .= '                                                                                               <tr>';
        $retour .= '                                                                                                   <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                       <div>';
        $retour .= '                                                                                                           <div style="font-family: inherit; text-align: inherit"></div>';
        $retour .= '                                                                                                           <div></div>';
        $retour .= '                                                                                                       </div>';
        $retour .= '                                                                                                   </td>';
        $retour .= '                                                                                               </tr>';
        $retour .= '                                                                                           </tbody>';
        $retour .= '                                                                                       </table>';
        $retour .= '                                                                                   </td>';
        $retour .= '                                                                               </tr>';
        $retour .= '                                                                           </tbody>';
        $retour .= '                                                                       </table>';
        $retour .= '                                                                       <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-2">';
        $retour .= '                                                                           <tbody>';
        $retour .= '                                                                               <tr>';
        $retour .= '                                                                                   <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                       <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                           <tbody>';
        $retour .= '                                                                                               <tr>';
        $retour .= '                                                                                                   <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                       <div>';
        $retour .= '                                                                                                           <div style="font-family: inherit; text-align: right">';
        $retour .= '                                                                                                               Livraison';
        $retour .= '                                                                                                           </div>';
        $retour .= '                                                                                                           <div></div>';
        $retour .= '                                                                                                       </div>';
        $retour .= '                                                                                                   </td>';
        $retour .= '                                                                                               </tr>';
        $retour .= '                                                                                           </tbody>';
        $retour .= '                                                                                       </table>';
        $retour .= '                                                                                   </td>';
        $retour .= '                                                                               </tr>';
        $retour .= '                                                                           </tbody>';
        $retour .= '                                                                       </table>';
        $retour .= '                                                                       <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-3">';
        $retour .= '                                                                           <tbody>';
        $retour .= '                                                                               <tr>';
        $retour .= '                                                                                   <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                       <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                           <tbody>';
        $retour .= '                                                                                               <tr>';
        $retour .= '                                                                                                   <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                       <div>';
        $retour .= '                                                                                                           <div style="font-family: inherit; text-align: right">'.$_POST['DeliveryTax'].'</div>';
        $retour .= '                                                                                                           <div></div>';
        $retour .= '                                                                                                       </div>';
        $retour .= '                                                                                                   </td>';
        $retour .= '                                                                                               </tr>';
        $retour .= '                                                                                           </tbody>';
        $retour .= '                                                                                       </table>';
        $retour .= '                                                                                   </td>';
        $retour .= '                                                                               </tr>';
        $retour .= '                                                                           </tbody>';
        $retour .= '                                                                       </table>';
        $retour .= '                                                                   </td>';
        $retour .= '                                                               </tr>';
        $retour .= '                                                           </tbody>';
        $retour .= '                                                       </table>';
        // $retour .= '                                                       <!-- END LIVRAISON -->';
    }
    if($_POST['Total'] != null && is_numeric($_POST['Total'])) {
        if(!tva_intra($_POST['Country'])) {
            // $retour .= '                                                    <!-- TVA -->';
            $retour .= '                                                    <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" role="module" data-type="columns" style="padding:0px 0px 0px 0px;" bgcolor="#0b1a25" data-distribution="1,1,1,1">';
            $retour .= '                                                        <tbody>';
            $retour .= '                                                            <tr role="module-content">';
            $retour .= '                                                                <td height="100%" valign="top">';
            $retour .= '                                                                    <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-0">';
            $retour .= '                                                                        <tbody>';
            $retour .= '                                                                            <tr>';
            $retour .= '                                                                                <td style="padding:0px;margin:0px;border-spacing:0;">';
            $retour .= '                                                                                    <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
            $retour .= '                                                                                        <tbody>';
            $retour .= '                                                                                            <tr>';
            $retour .= '                                                                                                <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
            $retour .= '                                                                                                    <div>';
            $retour .= '                                                                                                        <div style="font-family: inherit; text-align: inherit">';
            $retour .= '                                                                                                            ';
            $retour .= '                                                                                                        </div>';
            $retour .= '                                                                                                        <div></div>';
            $retour .= '                                                                                                    </div>';
            $retour .= '                                                                                                </td>';
            $retour .= '                                                                                            </tr>';
            $retour .= '                                                                                        </tbody>';
            $retour .= '                                                                                    </table>';
            $retour .= '                                                                                </td>';
            $retour .= '                                                                            </tr>';
            $retour .= '                                                                        </tbody>';
            $retour .= '                                                                    </table>';
            $retour .= '                                                                    <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-1">';
            $retour .= '                                                                        <tbody>';
            $retour .= '                                                                            <tr>';
            $retour .= '                                                                                <td style="padding:0px;margin:0px;border-spacing:0;">';
            $retour .= '                                                                                    <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
            $retour .= '                                                                                        <tbody>';
            $retour .= '                                                                                            <tr>';
            $retour .= '                                                                                                <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
            $retour .= '                                                                                                    <div>';
            $retour .= '                                                                                                        <div style="font-family: inherit; text-align: inherit">';
            $retour .= '                                                                                                            ';
            $retour .= '                                                                                                        </div>';
            $retour .= '                                                                                                        <div></div>';
            $retour .= '                                                                                                    </div>';
            $retour .= '                                                                                                </td>';
            $retour .= '                                                                                            </tr>';
            $retour .= '                                                                                        </tbody>';
            $retour .= '                                                                                    </table>';
            $retour .= '                                                                                </td>';
            $retour .= '                                                                            </tr>';
            $retour .= '                                                                        </tbody>';
            $retour .= '                                                                    </table>';
            $retour .= '                                                                    <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-2">';
            $retour .= '                                                                        <tbody>';
            $retour .= '                                                                            <tr>';
            $retour .= '                                                                                <td style="padding:0px;margin:0px;border-spacing:0;">';
            $retour .= '                                                                                    <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
            $retour .= '                                                                                        <tbody>';
            $retour .= '                                                                                            <tr>';
            $retour .= '                                                                                                <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
            $retour .= '                                                                                                    <div>';
            $retour .= '                                                                                                        <div style="font-family: inherit; text-align: right">';
            $retour .= '                                                                                                            TVA';
            $retour .= '                                                                                                        </div>';
            $retour .= '                                                                                                        <div></div>';
            $retour .= '                                                                                                    </div>';
            $retour .= '                                                                                                </td>';
            $retour .= '                                                                                            </tr>';
            $retour .= '                                                                                        </tbody>';
            $retour .= '                                                                                    </table>';
            $retour .= '                                                                                </td>';
            $retour .= '                                                                            </tr>';
            $retour .= '                                                                        </tbody>';
            $retour .= '                                                                    </table>';
            $retour .= '                                                                    <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-3">';
            $retour .= '                                                                        <tbody>';
            $retour .= '                                                                            <tr>';
            $retour .= '                                                                                <td style="padding:0px;margin:0px;border-spacing:0;">';
            $retour .= '                                                                                    <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
            $retour .= '                                                                                        <tbody>';
            $retour .= '                                                                                            <tr>';
            $retour .= '                                                                                                <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
            $retour .= '                                                                                                    <div>';
            $retour .= '                                                                                                        <div style="font-family: inherit; text-align: right">';
            $retour .= '                                                                                                            <span';
            $retour .= '                                                                                                                style="color: #f2f2f2; font-family: verdana, geneva, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(11, 26, 37); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline">';
            $retour .= '                                                                                                                '.($tva * 0.2).' EUR</span>';
            $retour .= '                                                                                                        </div>';
            $retour .= '                                                                                                        <div></div>';
            $retour .= '                                                                                                    </div>';
            $retour .= '                                                                                                </td>';
            $retour .= '                                                                                            </tr>';
            $retour .= '                                                                                        </tbody>';
            $retour .= '                                                                                    </table>';
            $retour .= '                                                                                </td>';
            $retour .= '                                                                            </tr>';
            $retour .= '                                                                        </tbody>';
            $retour .= '                                                                    </table>';
            $retour .= '                                                                </td>';
            $retour .= '                                                            </tr>';
            $retour .= '                                                        </tbody>';
            $retour .= '                                                    </table>';
            // $retour .= '                                                    <!-- END TVA -->';
        }
        // $retour .= '                                                        <!-- TOTAL -->';
        $retour .= '                                                        <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" role="module" data-type="columns" style="padding:0px 0px 0px 0px;" bgcolor="#0b1a25" data-distribution="1,1,1,1">';
        $retour .= '                                                            <tbody>';
        $retour .= '                                                                <tr role="module-content">';
        $retour .= '                                                                    <td height="100%" valign="top">';
        $retour .= '                                                                        <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-0">';
        $retour .= '                                                                            <tbody>';
        $retour .= '                                                                                <tr>';
        $retour .= '                                                                                    <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                        <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                            <tbody>';
        $retour .= '                                                                                                <tr>';
        $retour .= '                                                                                                    <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                        <div>';
        $retour .= '                                                                                                            <div style="font-family: inherit; text-align: inherit">';
        $retour .= '                                                                                                                ';
        $retour .= '                                                                                                            </div>';
        $retour .= '                                                                                                            <div></div>';
        $retour .= '                                                                                                        </div>';
        $retour .= '                                                                                                    </td>';
        $retour .= '                                                                                                </tr>';
        $retour .= '                                                                                            </tbody>';
        $retour .= '                                                                                        </table>';
        $retour .= '                                                                                    </td>';
        $retour .= '                                                                                </tr>';
        $retour .= '                                                                            </tbody>';
        $retour .= '                                                                        </table>';
        $retour .= '                                                                        <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-1">';
        $retour .= '                                                                            <tbody>';
        $retour .= '                                                                                <tr>';
        $retour .= '                                                                                    <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                        <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                            <tbody>';
        $retour .= '                                                                                                <tr>';
        $retour .= '                                                                                                    <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                        <div>';
        $retour .= '                                                                                                            <div style="font-family: inherit; text-align: inherit">';
        $retour .= '                                                                                                                ';
        $retour .= '                                                                                                            </div>';
        $retour .= '                                                                                                            <div></div>';
        $retour .= '                                                                                                        </div>';
        $retour .= '                                                                                                    </td>';
        $retour .= '                                                                                                </tr>';
        $retour .= '                                                                                            </tbody>';
        $retour .= '                                                                                        </table>';
        $retour .= '                                                                                    </td>';
        $retour .= '                                                                                </tr>';
        $retour .= '                                                                            </tbody>';
        $retour .= '                                                                        </table>';
        $retour .= '                                                                        <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-2">';
        $retour .= '                                                                            <tbody>';
        $retour .= '                                                                                <tr>';
        $retour .= '                                                                                    <td style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                        <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                            <tbody>';
        $retour .= '                                                                                                <tr>';
        $retour .= '                                                                                                    <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                        <div>';
        $retour .= '                                                                                                            <div style="font-family: inherit; text-align: right">';
        $retour .= '                                                                                                                Total';
        $retour .= '                                                                                                            </div>';
        $retour .= '                                                                                                            <div></div>';
        $retour .= '                                                                                                        </div>';
        $retour .= '                                                                                                    </td>';
        $retour .= '                                                                                                </tr>';
        $retour .= '                                                                                            </tbody>';
        $retour .= '                                                                                        </table>';
        $retour .= '                                                                                    </td>';
        $retour .= '                                                                                </tr>';
        $retour .= '                                                                            </tbody>';
        $retour .= '                                                                        </table>';
        $retour .= '                                                                        <table width="150" style="width:150px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-3">';
        $retour .= '                                                                            <tbody>';
        $retour .= '                                                                                <tr>';
        $retour .= '                                                                                    <td';
        $retour .= '                                                                                        style="padding:0px;margin:0px;border-spacing:0;">';
        $retour .= '                                                                                        <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
        $retour .= '                                                                                            <tbody>';
        $retour .= '                                                                                                <tr>';
        $retour .= '                                                                                                    <td style="padding:0px 0px 0px 0px; line-height:16px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
        $retour .= '                                                                                                        <div>';
        $retour .= '                                                                                                            <div style="font-family: inherit; text-align: right">';
        $retour .= '                                                                                                                <span style="color: #f2f2f2; font-family: verdana, geneva, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(11, 26, 37); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline">'.$_POST['Total'].'EUR</span>';
        $retour .= '                                                                                                            </div>';
        $retour .= '                                                                                                            <div></div>';
        $retour .= '                                                                                                        </div>';
        $retour .= '                                                                                                    </td>';
        $retour .= '                                                                                                </tr>';
        $retour .= '                                                                                            </tbody>';
        $retour .= '                                                                                        </table>';
        $retour .= '                                                                                    </td>';
        $retour .= '                                                                                </tr>';
        $retour .= '                                                                            </tbody>';
        $retour .= '                                                                        </table>';
        $retour .= '                                                                    </td>';
        $retour .= '                                                                </tr>';
        $retour .= '                                                            </tbody>';
        $retour .= '                                                        </table>';
        // $retour .= '                                                        <!-- END TOTAL -->';
    }
    // $retour .=  '                                                           <!-- END FACTURATION CONCLUSION -->';
    // $retour .=  '                                                           <!-- APPLICATION TVA -->';
    $retour .=  '                                                           <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .=  '                                                               <tbody>';
    $retour .=  '                                                                   <tr>';
    $retour .=  '                                                                       <td style="padding:20px 0px 20px 0px; line-height:12px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
    $retour .=  '                                                                           <div>';
    $retour .=  '                                                                               <div style="font-family: inherit; text-align: inherit">';
    $retour .=  '                                                                                   <span style="font-size: 12px">';
    if(tva_intra($_POST['Country']))
    {
        $retour .= '                            Exonération TVA, article 262 ter I du Code général des impôts<br/>';
        $retour .= '                            TVA intracommunautaire :'.$_POST['TVA_Intra'];
    }
    else
    {
        $retour .= '                            Application de la TVA, article 258-I-a du Code général des impôts';

    }
    $retour .= '                                                                                    </span></div>';
    $retour .= '                                                                                <div></div>';
    $retour .= '                                                                            </div>';
    $retour .= '                                                                        </td>';
    $retour .= '                                                                    </tr>';
    $retour .= '                                                                </tbody>';
    $retour .= '                                                            </table>';
    // $retour .= '                                                            <!-- END APPLICATION TVA -->';
    // $retour .= '                                                            <!-- BILLING -->';
    // $retour .= '                                                            <!-- BILLING TITLE -->';
    $retour .= orderZoneTitle('Détails de facturation');
    // $retour .= '                                                            <!-- END BILLING TITLE -->';
    $retour .= orderDivider();
    $retour .= orderBillingShippingLine('Facturé à', $_POST['Billing']['Firstname'].' '.$_POST['Billing']['Lastname']);
    $retour .= orderBillingShippingLine('Société', $_POST['Billing']['Address'].', '.(isset($_POST['Billing']['Address2']) ? $_POST['Billing']['Address2'].', ' : '').$_POST['Billing']['ZIP'].' '.$_POST['Billing']['City'].', '.$_POST['Billing']['Country']);
    if($_POST['Billing']['Society'] != null)
    {
        $retour .= orderBillingShippingLine('Au', $_POST['Billing']['Society']);
    }
    $retour .= orderBillingShippingLine('Mail', $_POST['Billing']['Mail']);
    $retour .= orderBillingShippingLine('Téléphone', $_POST['Billing']['Phone']);

    if(isset($_POST['Shipping']) && $_POST['Shipping'] != null) {
        // $retour .= '                                                            <!-- SHIPPING TITLE -->';
        $retour .= orderZoneTitle('Détails de livraison');
        // $retour .= '                                                            <!-- END SHIPPING TITLE -->';
        $retour .= orderDivider();
        // $retour .= '                                                            <!-- SHIPPING -->';
        $retour .= orderBillingShippingLine('Livré à', $_POST['Shipping']['Firstname'].' '.$_POST['Shipping']['Lastname']);
        $retour .= orderBillingShippingLine('Au', $_POST['Shipping']['Address'].', '.(isset($_POST['Shipping']['Address2']) ? $_POST['Shipping']['Address2'].', ' : '').$_POST['Shipping']['ZIP'].' '.$_POST['Shipping']['City'].', '.$_POST['Shipping']['Country']);
        if($_POST['Shipping']['Society'] != null)
        {
            $retour .= orderBillingShippingLine('Pour la société', $_POST['Shipping']['Society']);
        }
        if($_POST['Shipping']['Mail'] != null)
        {
            $retour .= orderBillingShippingLine('Mail', $_POST['Shipping']['Mail']);
        }
        $retour .= orderBillingShippingLine('Téléphone', $_POST['Shipping']['Phone']);
        // $retour .= '                                                            <!-- END SHIPPING -->';
    }
    // $retour .= '                                                            <!-- ESPACE -->';
    $retour .= '                                                            <table class="module" role="module" data-type="spacer" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                <tbody>';
    $retour .= '                                                                    <tr>';
    $retour .= '                                                                        <td style="padding:0px 0px 30px 0px;" role="module-content" bgcolor="">';
    $retour .= '                                                                        </td>';
    $retour .= '                                                                    </tr>';
    $retour .= '                                                                </tbody>';
    $retour .= '                                                            </table>';
    // $retour .= '                                                            <!-- END ESPACE -->';

    // $retour .= '                                                            <!-- SOCIAL -->';
    $retour .= '                                                            <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" role="module" data-type="columns" style="padding:15px 150px 0px 150px;" bgcolor="#0b1a25" data-distribution="1,1,1,1">';
    $retour .= '                                                                <tbody>';
    $retour .= '                                                                    <tr role="module-content">';
    $retour .= '                                                                        <td height="100%" valign="top">';
    $retour .= '                                                                            <table width="75" style="width:75px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-0">';
    $retour .= '                                                                                <tbody>';
    $retour .= '                                                                                    <tr>';
    $retour .= '                                                                                        <td style="padding:0px;margin:0px;border-spacing:0;">';
    $retour .= '                                                                                            <table class="wrapper" role="module" data-type="image" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                                                <tbody>';
    $retour .= '                                                                                                    <tr>';
    $retour .= '                                                                                                        <td style="font-size:6px; line-height:10px; padding:0px 0px 0px 0px;" valign="top" align="center">';
    $retour .= '                                                                                                            <a href="https://www.facebook.com/inmode.france">';
    $retour .= '                                                                                                                <img class="max-width" border="0" style="display:block; color:#000000; text-decoration:none; font-family:Helvetica, arial, sans-serif; font-size:16px; max-width:40% !important; width:40%; height:auto !important;" width="30" alt="" data-proportionally-constrained="true" data-responsive="true" src="https://inmode.emeka.fr/back/assets/icons/facebook.png">';
    $retour .= '                                                                                                            </a>';
    $retour .= '                                                                                                        </td>';
    $retour .= '                                                                                                    </tr>';
    $retour .= '                                                                                                </tbody>';
    $retour .= '                                                                                            </table>';
    $retour .= '                                                                                        </td>';
    $retour .= '                                                                                    </tr>';
    $retour .= '                                                                                </tbody>';
    $retour .= '                                                                            </table>';
    $retour .= '                                                                            <table width="75" style="width:75px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-1">';
    $retour .= '                                                                                <tbody>';
    $retour .= '                                                                                    <tr>';
    $retour .= '                                                                                        <td style="padding:0px;margin:0px;border-spacing:0;">';
    $retour .= '                                                                                            <table class="wrapper" role="module" data-type="image" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                                                <tbody>';
    $retour .= '                                                                                                    <tr>';
    $retour .= '                                                                                                        <td style="font-size:6px; line-height:10px; padding:0px 0px 0px 0px;" valign="top" align="center">';
    $retour .= '                                                                                                            <a href="https://www.instagram.com/inmode.france">';
    $retour .= '                                                                                                                <img class="max-width" border="0" style="display:block; color:#000000; text-decoration:none; font-family:Helvetica, arial, sans-serif; font-size:16px; max-width:40% !important; width:40%; height:auto !important;" width="30" alt="" data-proportionally-constrained="true" data-responsive="true" src="https://inmode.emeka.fr/back/assets/icons/instagram.png">';
    $retour .= '                                                                                                            </a>';
    $retour .= '                                                                                                        </td>';
    $retour .= '                                                                                                    </tr>';
    $retour .= '                                                                                                </tbody>';
    $retour .= '                                                                                            </table>';
    $retour .= '                                                                                        </td>';
    $retour .= '                                                                                    </tr>';
    $retour .= '                                                                                </tbody>';
    $retour .= '                                                                            </table>';
    $retour .= '                                                                            <table width="75" style="width:75px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-2">';
    $retour .= '                                                                                <tbody>';
    $retour .= '                                                                                    <tr>';
    $retour .= '                                                                                        <td style="padding:0px;margin:0px;border-spacing:0;">';
    $retour .= '                                                                                            <table class="wrapper" role="module" data-type="image" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                                                <tbody>';
    $retour .= '                                                                                                    <tr>';
    $retour .= '                                                                                                        <td style="font-size:6px; line-height:10px; padding:0px 0px 0px 0px;" valign="top" align="center">';
    $retour .= '                                                                                                            <a href="https://www.youtube.com/user/InModeSolutions">';
    $retour .= '                                                                                                                <img class="max-width" border="0" style="display:block; color:#000000; text-decoration:none; font-family:Helvetica, arial, sans-serif; font-size:16px; max-width:40% !important; width:40%; height:auto !important;" width="30" alt="" data-proportionally-constrained="true" data-responsive="true" src="https://inmode.emeka.fr/back/assets/icons/youtube.png">';
    $retour .= '                                                                                                            </a>';
    $retour .= '                                                                                                        </td>';
    $retour .= '                                                                                                    </tr>';
    $retour .= '                                                                                                </tbody>';
    $retour .= '                                                                                            </table>';
    $retour .= '                                                                                        </td>';
    $retour .= '                                                                                    </tr>';
    $retour .= '                                                                                </tbody>';
    $retour .= '                                                                            </table>';
    $retour .= '                                                                            <table width="75" style="width:75px; border-spacing:0; border-collapse:collapse; margin:0px 0px 0px 0px;" cellpadding="0" cellspacing="0" align="left" border="0" bgcolor="" class="column column-3">';
    $retour .= '                                                                                <tbody>';
    $retour .= '                                                                                    <tr>';
    $retour .= '                                                                                        <td style="padding:0px;margin:0px;border-spacing:0;">';
    $retour .= '                                                                                            <table class="wrapper" role="module" data-type="image" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                                                <tbody>';
    $retour .= '                                                                                                    <tr>';
    $retour .= '                                                                                                        <td style="font-size:6px; line-height:10px; padding:0px 0px 0px 0px;" valign="top" align="center">';
    $retour .= '                                                                                                            <a href="https://www.linkedin.com/company/inmode-solutions-france/">';
    $retour .= '                                                                                                                <img class="max-width" border="0" style="display:block; color:#000000; text-decoration:none; font-family:Helvetica, arial, sans-serif; font-size:16px; max-width:40% !important; width:40%; height:auto !important;" width="30" alt="" data-proportionally-constrained="true" data-responsive="true" src="https://inmode.emeka.fr/back/assets/icons/linkedin.png">';
    $retour .= '                                                                                                            </a>';
    $retour .= '                                                                                                        </td>';
    $retour .= '                                                                                                    </tr>';
    $retour .= '                                                                                                </tbody>';
    $retour .= '                                                                                            </table>';
    $retour .= '                                                                                        </td>';
    $retour .= '                                                                                    </tr>';
    $retour .= '                                                                                </tbody>';
    $retour .= '                                                                            </table>';
    $retour .= '                                                                        </td>';
    $retour .= '                                                                    </tr>';
    $retour .= '                                                                </tbody>';
    $retour .= '                                                            </table>';
    // $retour .= '                                                            <!-- END SOCIAL -->';
    // $retour .= '                                                            <!-- ADMINISTRATIF -->';
    $retour .= '                                                            <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                <tbody>';
    $retour .= '                                                                    <tr>';
    $retour .= '                                                                        <td style="padding:0px 0px 0px 0px; line-height:20px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
    $retour .= '                                                                            <div>';
    $retour .= '                                                                                <div style="font-family: inherit; text-align: center">';
    $retour .= '                                                                                    <span style="font-size: 14px"><strong>InmodeMD</strong></span>';
    $retour .= '                                                                                </div>';
    $retour .= '                                                                                <div></div>';
    $retour .= '                                                                            </div>';
    $retour .= '                                                                        </td>';
    $retour .= '                                                                    </tr>';
    $retour .= '                                                                </tbody>';
    $retour .= '                                                            </table>';
    $retour .= '                                                            <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                <tbody>';
    $retour .= '                                                                    <tr>';
    $retour .= '                                                                        <td style="padding:0px 0px 0px 0px; line-height:20px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
    $retour .= '                                                                            <div>';
    $retour .= '                                                                                <div style="font-family: inherit; text-align: center">';
    $retour .= '                                                                                    <span style="font-size: 14px"><strong>RCS de Paris - 12 Place Dauphiné,</strong></span>';
    $retour .= '                                                                                </div>';
    $retour .= '                                                                                <div></div>';
    $retour .= '                                                                            </div>';
    $retour .= '                                                                        </td>';
    $retour .= '                                                                    </tr>';
    $retour .= '                                                                </tbody>';
    $retour .= '                                                            </table>';
    $retour .= '                                                            <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                <tbody>';
    $retour .= '                                                                    <tr>';
    $retour .= '                                                                        <td style="padding:0px 0px 0px 0px; line-height:20px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
    $retour .= '                                                                            <div>';
    $retour .= '                                                                                <div style="font-family: inherit; text-align: center">';
    $retour .= '                                                                                    <span style="font-size: 14px"><strong>75001';
    $retour .= '                                                                                            Paris</strong></span></div>';
    $retour .= '                                                                                <div></div>';
    $retour .= '                                                                            </div>';
    $retour .= '                                                                        </td>';
    $retour .= '                                                                    </tr>';
    $retour .= '                                                                </tbody>';
    $retour .= '                                                            </table>';
    $retour .= '                                                            <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                <tbody>';
    $retour .= '                                                                    <tr>';
    $retour .= '                                                                        <td style="padding:0px 0px 0px 0px; line-height:20px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
    $retour .= '                                                                            <div>';
    $retour .= '                                                                                <div style="font-family: inherit; text-align: center">';
    $retour .= '                                                                                    <span style="font-size: 14px"><strong>884 502 980 00011</strong></span></div>';
    $retour .= '                                                                                <div></div>';
    $retour .= '                                                                            </div>';
    $retour .= '                                                                        </td>';
    $retour .= '                                                                    </tr>';
    $retour .= '                                                                </tbody>';
    $retour .= '                                                            </table>';
    $retour .= '                                                            <table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;">';
    $retour .= '                                                                <tbody>';
    $retour .= '                                                                    <tr>';
    $retour .= '                                                                        <td style="padding:0px 0px 0px 0px; line-height:20px; text-align:inherit;" height="100%" valign="top" bgcolor="" role="module-content">';
    $retour .= '                                                                            <div>';
    $retour .= '                                                                                <div style="font-family: inherit; text-align: center">';
    $retour .= '                                                                                    <a href="mailto:contact.fr@inmodemd.fr?subject=Commande '.$_POST['Reference'].' - Requête"><span style="font-size: 14px"><strong>contact.fr@inmodemd.fr</strong></span></a>';
    $retour .= '                                                                                </div>';
    $retour .= '                                                                                <div></div>';
    $retour .= '                                                                            </div>';
    $retour .= '                                                                        </td>';
    $retour .= '                                                                    </tr>';
    $retour .= '                                                                </tbody>';
    $retour .= '                                                            </table>';
    // $retour .= '                                                            <!-- END ADMINISTRATIF -->';
    $retour .= '                                                        </td>';
    $retour .= '                                                    </tr>';
    $retour .= '                                                </table>';
    $retour .= '                                                <!--[if mso]>';
    $retour .= '                                                                </td>';
    $retour .= '                                                            </tr>';
    $retour .= '                                                        </table>';
    $retour .= '                                                    </center>';
    $retour .= '                                                <![endif]-->';
    $retour .= '                                            </td>';
    $retour .= '                                        </tr>';
    $retour .= '                                    </table>';
    $retour .= '                                </td>';
    $retour .= '                            </tr>';
    $retour .= '                        </table>';
    $retour .= '                    </td>';
    $retour .= '                </tr>';
    $retour .= '            </table>';
    $retour .= '        </div>';
    $retour .= '    </center>';
    $retour .= '</body>';
    $retour .= '</html>';

    return $retour;
}